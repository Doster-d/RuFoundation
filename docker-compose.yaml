version: "3.9"
services:
  web:
    build: .
    ports:
      - "8000:8000"
    volumes:
      - "./files:/app/files"
      - "./archive:/app/archive:ro"
    env_file:
      - prod-web.env
    environment:
      DB_ENGINE: pg
      DB_PG_HOST: postgres
      DB_PG_USERNAME: pguser
      DB_PG_PASSWORD: pguser
      # EMAIL_ENGINE: smtp
      # EMAIL_HOST: mailer
      # EMAIL_PORT: 587
  postgres:
    image: "postgres:14"
    volumes:
      - "./postgresql:/var/lib/postgresql"
    environment:
      POSTGRES_USER: pguser
      POSTGRES_PASSWORD: pguser
      POSTGRES_DB: scpwiki
  # mailer:
  #   image: "boky/postfix"
  #   env_file:
  #     - prod-mailer.env
